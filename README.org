* Welcome to Sensu
  Sensu is a monitoring system framework, handling the remote execution of checks.

* License
  Sensu is released under the [[https://github.com/sonian/sensu/blob/master/MIT-LICENSE.txt][MIT license]].

* Contributing
  - [[http://help.github.com/fork-a-repo/][Fork]] [[https://github.com/sonian/sensu][Sensu]]
  - Use a [[https://github.com/dchelimsky/rspec/wiki/Topic-Branches][topic branch]]
  - Create a [[http://help.github.com/send-pull-requests/][pull request]]

  Keep it simple.

** Readme Driven Development
*** A Client Will
  - Have a set of attributes to describe it, including its responsibilities
  - Send keep-alives to a server
  - Subscribe to a set of queues bound to a set of fanout exchanges, determined by its responsibilities
  - Substitute tokens in check commands with their matching client attribute
  - Receive checks from subscriptions, execute them, and publish the results to a queue with its client name
  - Not allow overlapping check executions of the same name
  - Report when it is unaware of a check it received from a subscription

*** A Server Will
  - Subscribe to a queue for check scheduling, another for check results
  - Populate the check scheduling queue using a JSON config file
  - Pull a check from the check scheduling queue and push it onto its associated fanout exchanges
  - Pull check results, storing the latest events for clients, a good result will flush a previous event for that client
  - Create an event when it stops receiving keep-alives from a client, a new keep-alive for the client will clear the event
  - Trigger a event handler, determined by the type of the check that produced the event, providing it with a JSON event file

*** An API Will
  - List all current events
  - List all clients and their attributes
  - Show a client and its attributes
  - Remove a client and resolve associated events

*** A Plugin Will
  - Output to STDOUT
  - Return a valid exit status code

*** A Handler Will
  - Accept a command line argument "-f", for an event file path
  - Parse the JSON event file
  - Handle the event as it wishes

** Local Setup
*** Configure RabbitMQ
  user

  : rabbitmqctl add_user sensu password

  vhost

  : rabbitmqctl add_vhost /sensu

  permissions

  : rabbitmqctl set_permissions -p /sensu sensu ".*" ".*" ".*"

  /usr/local/etc/rabbitmq/rabbitmq.config

  substitute **PATH** with your Sensu project path

  : [
  :   {rabbit, [
  :     {ssl_listeners, [5671]},
  :     {ssl_options, [{cacertfile,"*PATH*/certs/testca/cacert.pem"},
  :                    {certfile,"*PATH*/certs/server/cert.pem"},
  :                    {keyfile,"*PATH*/certs/server/key.pem"},
  :                    {verify,verify_peer},
  :                    {fail_if_no_peer_cert,true}]}
  :   ]}
  : ].
